{"ast":null,"code":"var _jsxFileName = \"/Users/kirilldikalin/work/moscow_streets/src/components/YandexMap.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useImperativeHandle, forwardRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst YandexMap = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c = _s(({\n  streets,\n  learnedStreets,\n  onStreetClick\n}, ref) => {\n  _s();\n  const mapRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const objectsRef = useRef([]);\n  useEffect(() => {\n    // Загрузка API Яндекс Карт\n    const script = document.createElement('script');\n    script.src = 'https://api-maps.yandex.ru/2.1/?apikey=302af765-6c16-4994-992f-ec50c7f8746c&lang=ru_RU';\n    script.async = true;\n    script.onload = initMap;\n    document.body.appendChild(script);\n    return () => {\n      document.body.removeChild(script);\n    };\n  }, []);\n  useEffect(() => {\n    if (mapInstanceRef.current) {\n      updateStreets();\n    }\n  }, [streets, learnedStreets]);\n  useEffect(() => {\n    if (mapInstanceRef.current) {\n      const marker = new window.ymaps.Placemark([55.75, 37.61], {\n        balloonContent: 'Тестовый маркер'\n      });\n      mapInstanceRef.current.geoObjects.add(marker);\n    }\n  }, []);\n  const initMap = () => {\n    window.ymaps.ready(() => {\n      if (mapRef.current) {\n        mapInstanceRef.current = new window.ymaps.Map(mapRef.current, {\n          center: [55.76, 37.64],\n          // Центр Москвы\n          zoom: 12,\n          controls: ['zoomControl', 'fullscreenControl']\n        });\n        console.log('Передано в карту:', streets);\n        updateStreets();\n      }\n    });\n  };\n  const updateStreets = () => {\n    // Очистка предыдущих объектов\n    objectsRef.current.forEach(obj => {\n      mapInstanceRef.current.geoObjects.remove(obj);\n    });\n    objectsRef.current = [];\n    streets.forEach(street => {\n      const isLearned = learnedStreets.includes(street.name);\n      const coords = street.coordinates;\n      // Проверка на валидность координат\n      if (!Array.isArray(coords) || coords.length === 0 || isNaN(coords[0][0]) || isNaN(coords[0][1])) {\n        console.log('Некорректные координаты:', coords, street.name);\n        return;\n      }\n      // Если координаты совпадают или их меньше двух — рисуем маркер\n      if (coords.length < 2 || coords[0][0] === coords[1][0] && coords[0][1] === coords[1][1]) {\n        const marker = new window.ymaps.Placemark(coords[0], {\n          balloonContent: street.name\n        }, {\n          preset: isLearned ? 'islands#greenDotIcon' : 'islands#redDotIcon'\n        });\n        mapInstanceRef.current.geoObjects.add(marker);\n        objectsRef.current.push(marker);\n        if (isLearned) {\n          mapInstanceRef.current.setCenter(coords[0], 15, {\n            duration: 300\n          });\n        }\n        console.log('Маркер:', street.name, coords[0]);\n        return;\n      }\n      // Если есть линия — рисуем линию\n      const polyline = new window.ymaps.Polyline(coords, {\n        balloonContent: street.name\n      }, {\n        strokeColor: isLearned ? '#4CAF50' : '#FF0000',\n        strokeWidth: 8,\n        opacity: 1,\n        zIndex: 1000\n      });\n      mapInstanceRef.current.geoObjects.add(polyline);\n      objectsRef.current.push(polyline);\n      if (isLearned) {\n        mapInstanceRef.current.setCenter(coords[0], 15, {\n          duration: 300\n        });\n      }\n      console.log('Линия:', street.name, coords);\n    });\n  };\n  useImperativeHandle(ref, () => updateStreets);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: mapRef,\n    style: {\n      width: '100%',\n      height: '100%'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 10\n  }, this);\n}, \"uPq91xC+D4tC1NaclyekZ2hD/Lg=\")), \"uPq91xC+D4tC1NaclyekZ2hD/Lg=\");\n_c2 = YandexMap;\nexport default YandexMap;\nvar _c, _c2;\n$RefreshReg$(_c, \"YandexMap$forwardRef\");\n$RefreshReg$(_c2, \"YandexMap\");","map":{"version":3,"names":["React","useEffect","useRef","useImperativeHandle","forwardRef","jsxDEV","_jsxDEV","YandexMap","_s","_c","streets","learnedStreets","onStreetClick","ref","mapRef","mapInstanceRef","objectsRef","script","document","createElement","src","async","onload","initMap","body","appendChild","removeChild","current","updateStreets","marker","window","ymaps","Placemark","balloonContent","geoObjects","add","ready","Map","center","zoom","controls","console","log","forEach","obj","remove","street","isLearned","includes","name","coords","coordinates","Array","isArray","length","isNaN","preset","push","setCenter","duration","polyline","Polyline","strokeColor","strokeWidth","opacity","zIndex","style","width","height","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["/Users/kirilldikalin/work/moscow_streets/src/components/YandexMap.tsx"],"sourcesContent":["import React, { useEffect, useRef, useImperativeHandle, forwardRef } from 'react';\nimport { Street } from '../data/districts';\n\ndeclare global {\n  interface Window {\n    ymaps: any;\n  }\n}\n\ninterface YandexMapProps {\n  streets: Street[];\n  learnedStreets: string[];\n  onStreetClick?: (street: Street) => void;\n}\n\nconst YandexMap = forwardRef<any, YandexMapProps>(({ streets, learnedStreets, onStreetClick }, ref) => {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const mapInstanceRef = useRef<any>(null);\n  const objectsRef = useRef<any[]>([]);\n\n  useEffect(() => {\n    // Загрузка API Яндекс Карт\n    const script = document.createElement('script');\n    script.src = 'https://api-maps.yandex.ru/2.1/?apikey=302af765-6c16-4994-992f-ec50c7f8746c&lang=ru_RU';\n    script.async = true;\n    script.onload = initMap;\n    document.body.appendChild(script);\n\n    return () => {\n      document.body.removeChild(script);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (mapInstanceRef.current) {\n      updateStreets();\n    }\n  }, [streets, learnedStreets]);\n\n  useEffect(() => {\n    if (mapInstanceRef.current) {\n      const marker = new window.ymaps.Placemark([55.75, 37.61], { balloonContent: 'Тестовый маркер' });\n      mapInstanceRef.current.geoObjects.add(marker);\n    }\n  }, []);\n\n  const initMap = () => {\n    window.ymaps.ready(() => {\n      if (mapRef.current) {\n        mapInstanceRef.current = new window.ymaps.Map(mapRef.current, {\n          center: [55.76, 37.64], // Центр Москвы\n          zoom: 12,\n          controls: ['zoomControl', 'fullscreenControl']\n        });\n        console.log('Передано в карту:', streets);\n        updateStreets();\n      }\n    });\n  };\n\n  const updateStreets = () => {\n    // Очистка предыдущих объектов\n    objectsRef.current.forEach(obj => {\n      mapInstanceRef.current.geoObjects.remove(obj);\n    });\n    objectsRef.current = [];\n\n    streets.forEach(street => {\n      const isLearned = learnedStreets.includes(street.name);\n      const coords = street.coordinates;\n      // Проверка на валидность координат\n      if (\n        !Array.isArray(coords) ||\n        coords.length === 0 ||\n        isNaN(coords[0][0]) || isNaN(coords[0][1])\n      ) {\n        console.log('Некорректные координаты:', coords, street.name);\n        return;\n      }\n      // Если координаты совпадают или их меньше двух — рисуем маркер\n      if (\n        coords.length < 2 ||\n        (coords[0][0] === coords[1][0] && coords[0][1] === coords[1][1])\n      ) {\n        const marker = new window.ymaps.Placemark(coords[0], {\n          balloonContent: street.name\n        }, {\n          preset: isLearned ? 'islands#greenDotIcon' : 'islands#redDotIcon'\n        });\n        mapInstanceRef.current.geoObjects.add(marker);\n        objectsRef.current.push(marker);\n        if (isLearned) {\n          mapInstanceRef.current.setCenter(coords[0], 15, { duration: 300 });\n        }\n        console.log('Маркер:', street.name, coords[0]);\n        return;\n      }\n      // Если есть линия — рисуем линию\n      const polyline = new window.ymaps.Polyline(\n        coords,\n        { balloonContent: street.name },\n        {\n          strokeColor: isLearned ? '#4CAF50' : '#FF0000',\n          strokeWidth: 8,\n          opacity: 1,\n          zIndex: 1000\n        }\n      );\n      mapInstanceRef.current.geoObjects.add(polyline);\n      objectsRef.current.push(polyline);\n      if (isLearned) {\n        mapInstanceRef.current.setCenter(coords[0], 15, { duration: 300 });\n      }\n      console.log('Линия:', street.name, coords);\n    });\n  };\n\n  useImperativeHandle(ref, () => updateStreets);\n\n  return <div ref={mapRef} style={{ width: '100%', height: '100%' }} />;\n});\n\nexport default YandexMap; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}